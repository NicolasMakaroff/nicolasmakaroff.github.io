<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Finance Project</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->





<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><div><img src="DataScienceLogo.png"height=30 width=30></img>   HOME</div></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    School Project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">First year</a>
      <ul class="dropdown-menu" role="menu">
        <li class="dropdown-header">Maths Projects</li>
        <li>
          <a href="financeproject.html">Finance Project</a>
        </li>
        <li class="dropdown-submenu">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Statistics</a>
          <ul class="dropdown-menu" role="menu">
            <li>
              <a href="tp2.html">TP2</a>
            </li>
            <li>
              <a href="tp3.html">TP3</a>
            </li>
            <li>
              <a href="tp4.html">TP4</a>
            </li>
            <li>
              <a href="projectstat.html">Project</a>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Computer Science Projects</li>
    <li>
      <a href="ipf.html">Functional programming</a>
    </li>
    <li>
      <a href="ilo.html">Small Figure Editor</a>
    </li>
    <li>
      <a href="smartpointers.html">SmartPointers</a>
    </li>
    <li class="divider"></li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Personal Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="preypredator.html">Prey-Predator Simulation</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    DataScIIEnce
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="introduction.html">Introductory Presentation</a>
    </li>
  </ul>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Finance Project</h1>

</div>


<div id="cox-ross-rubinstein-model" class="section level1">
<h1>Cox-Ross-Rubinstein Model</h1>
<p>Let <span class="math inline">\(t_{0}=0\)</span>, <span class="math inline">\(t_{N}=T\)</span> and <span class="math inline">\(t_{i+1}-t{i}=\delta\)</span> with <span class="math inline">\((t_{i}) _{0 \leqslant i \leqslant N}, \forall i \in \{1,...,N-1\}\)</span> where <span class="math inline">\(\delta=\frac{T}{N}\)</span>. We define for the rest of the subject the following variables :</p>
<ul>
<li><strong>The price of the risk-free asset :</strong> <span class="math inline">\(S_{t_{i}}^{0}=(1+r_{N})^{i}, \forall i \in \{0,...,N\}\)</span></li>
<li><strong>The price of the risk asset :</strong>
<ul>
<li><span class="math inline">\(S_{0}^{(N)}=s &gt; 0\)</span></li>
<li><span class="math inline">\(S_{t_{i}}^{(N)}=T_{i}^{(N)}S_{t_{i-1}}^{(N)}, \forall i \in \{1,...,N\}\)</span></li>
</ul></li>
</ul>
<div id="question-1" class="section level4">
<h4><strong>Question 1</strong></h4>
<p>Let <span class="math inline">\(\mathbb{Q}\)</span> be the risk-neutral probability and <span class="math inline">\(\mathcal{F}_{k}=\sigma(S_{t_{i}})\)</span>. Define <span class="math inline">\(q_{N}=\mathbb{Q}[T_{1}^{(N)}=1+\textit{h}_{N}]\)</span> On one side we know that <span class="math inline">\(S_{t_1}^{(N)}\)</span> is a martingales under <span class="math inline">\(\mathbb{Q}\)</span> and with the definition <span class="math inline">\(\tilde{S}_{t_1}^{(N)} = \frac{s\times T_{1}^{(N)}}{1+r_N}\)</span> and <span class="math inline">\(\mathbb{E}[\tilde{S}_{t_1}^{(N)}|\mathcal{F}_0]=S_0^{(N)}=s\)</span> And on the other side <span class="math inline">\(T_1^{(N)}(\Omega)=\{1+b_N,1+h_N\}\)</span> Then <span class="math display">\[\forall s&gt;0, s=\frac{1}{1+r_N}(s(1+h_N)q_N + s(1+b_N)(1-q_N))\]</span> Finally <span class="math display">\[q_N=\frac{r_N - b_N}{h_N - b_N}\]</span></p>
<p>Soit <span class="math inline">\(\mathbb{Q}\)</span> tq <span class="math inline">\(\mathbb{E}[\frac{S_{t_{i+1}}}{S_{t_{i}}}/F_{t_{i}}]=\mathbb{E}[\frac{S^{o}_{t_{i+1}}}{S_{t_{i}}}/F_{t_{i}}]=\mathbb{E}[\frac{T_{i+1}S_{ti}}{S_{ti}}/\mathcal{F}_{i}]\)</span></p>
<p>Let <span class="math inline">\(\frac{1}{(1+r_{n})^{N}}\mathbb{E}[f(S_{t_{N}})]\)</span> donc <span class="math inline">\(S_{tN}=s(1+h_{N})^{X}(1+b_{N})^{N-X}\)</span> donc <span class="math inline">\(S_{t_{0}}=s\)</span> Ainsi <span class="math inline">\(X~\mathcal{B}(N,q_{N})\)</span></p>
</div>
<div id="question-2" class="section level4">
<h4><strong>Question 2</strong></h4>
<p>Let <span class="math inline">\(p_{(N)}=\frac{1}{(1+r_N)^N}\mathbb{E}[f(S_{t_N}^{(N)})]\)</span> We see that : <span class="math inline">\(\forall k \in \{1,...,N\}, S_{t_N}^{(N)}= (\prod\limits_{i=1}^{N} T_i^{(N)})\times s\)</span> Moreover: <span class="math display">\[ \mathbb{E}_{\mathbb{Q}}[f(S_{t_N}^{(N)}]=\sum\limits_{\alpha\in S_{t_N}^{(N)}(\Omega)}f(\alpha)\mathbb{Q}(S_{t_N}^{(N)}=\alpha)\]</span> But the <span class="math inline">\((T_i^{(N)})_{i\in\{1,...,N\}}\)</span> are i.i.d and are equals to either <span class="math inline">\(( 1+h_N)\)</span> or <span class="math inline">\((1+b_N)\)</span> with z probability of, resp. , <span class="math inline">\((q_N)\)</span> et <span class="math inline">\((1-q_N)\)</span> then with the definition we have: <span class="math inline">\(\forall\alpha\in S_{t_N}^{(N)}(\Omega), \exists (i,j)\in\mathbb{N}^2 | i+j = N\)</span> et <span class="math inline">\(\alpha=(1+h_N)^i(1+b_N)^j s\)</span>, <span class="math display">\[\mathbb{E}_{\mathbb{Q}}[f(S_{t_N}^{(N)})]=\sum\limits_{(i,j)\in\mathbb{N}^2}^{i+j=N} f((1+h_N)^i(1+b_N)^j s)q_N^i (1-q_N)^j\]</span> <span class="math display">\[= \sum\limits_{i=0}^N \dbinom{N}{i} ((1+h_N)^i(1+b_N)^{N-i}q_N^i(1-q_N)^{N-i}\]</span> Finally: <span class="math display">\[p_{(N)}=\frac{1}{(1+r_N)^N}\times\sum\limits_{i=0}^N \dbinom{N}{i} ((1+h_N)^i(1+b_N)^{N-i}q_N^i(1-q_N)^{N-i}\]</span></p>
</div>
<div id="first-pricer" class="section level3">
<h3>First pricer</h3>
<div id="question" class="section level4">
<h4><strong>Question</strong></h4>
<p>[language=Python,caption={Implémentation de Price1}]</p>
<pre class="python"><code>from scipy import special

def price1(N,rN,hN,bN,s,f):
    qN = (rN-bN)/(hN-bN)
    return 1.0/((1.0+rN)**N) * sum([special.comb(N,i)*f(s*((1+hN)**i)*((1+bN)**(N-i)))*(qN**i)*((1-qN)**(N-i)) for i in range(N)])
    
def f(x):
    return max(x-90,0)</code></pre>
<pre><code>The output for the following value $s=100$, $h_N=0.05$, $b_N=-0.05$, $r_N=0.01$, $N=30$ et $f(x)=max(x-90,0)$</code></pre>

</div>
</div>
<div id="second-pricer" class="section level3">
<h3>Second Pricer</h3>
<div id="question-3" class="section level4">
<h4><strong>Question</strong></h4>
<p>[language=Python,caption=Implémentation de Price2]</p>
<pre class="python"><code>def price2(N,rN,hN,bN,s,f):
    cst=1/(1+rN)
    qN=(rN-bN)/(hN-bN)
    M =np.zeros((N+2,N+2),float)
    for i in range(1,N+1):
        M[i,N+1]=f(s*(1+hN)**(N-i+1)*(1+bN)**(i-1)) 
    for j in range(N,0,-1):
        for k in range(1,j+1):
            M[k,j]=cst*(M[k,j+1]*qN+M[k+1,j+1]*(1-qN)) 
    
    return M[1,1] </code></pre>
</div>
<div id="question-4" class="section level4">
<h4><strong>Question</strong></h4>


</div>
</div>
<div id="comparison" class="section level3">
<h3>Comparison</h3>
<div id="question-5" class="section level4">
<h4><strong>Question</strong></h4>
<p>[language=Python,caption=Comparaison de Price1 et Price2]</p>
<pre class="python"><code>import random

def compare(rN,hN,bN,s,f):
    N=random.randint(5,15)
    print(N)
    print(price1(N,rN,hN,bN,s,f))
    print(price2(N,rN,hN,bN,s,f))</code></pre>

</div>
</div>
<div id="the-financial-cover" class="section level3">
<h3>The financial cover</h3>
<p>On the final date, our portfolio must verify : <span class="math display">\[\alpha_{N-1}(S_{t_{N-1}}^{(N)})S_{t_N}^{(N)} +\beta_{N-1}(S_{t_{N-1}}^{(N)})S_{t_N}^{0}=f(S_{t_N}^{(N)})\]</span></p>
<p>In this section, we suppose that at the <span class="math inline">\(T\)</span> date, we are two states:</p>
<ul>
<li><span class="math inline">\(S_{t_N}^{(N)}=(1+h_N)S_{t_{N-1}}^{(N)}\)</span></li>
<li><span class="math inline">\(S_{t_N}^{(N)}=(1+b_N)S_{t_{N-1}}^{(N)}\)</span></li>
</ul>
<p>We have the following system : <span class="math display">\[\alpha_{N-1}(S_{t_{N-1}}^{(N)})(1 + h_N)S_{t_{N-1}}^{(N)} +\beta_{N-1}(S_{t_{N-1}}^{(N)})S_{t_N}^{0}=f((1+h_N)S_{t_{N-1}}^{(N)})\]</span></p>
<p><span class="math display">\[\alpha_{N-1}(S_{t_{N-1}}^{(N)})(1+b_N)S_{t_{N-1}}^{(N)} +\beta_{N-1}(S_{t_{N-1}}^{(N)})S_{t_N}^{0}=f((1+b_N)S_{t_{N-1}}^{(N)})\]</span></p>
<p>Which gives us :</p>
<p><span class="math display">\[\alpha_{N-1}(S_{t_{N-1}}^{(N)})S_{t_{N-1}}^{(N)}(h_N - b_N)=f((1 + h_N)S_{t_{N-1}}^{(N)}) - f((1 + b_N)S_{t_{N-1}}^{(N)})\]</span> <span class="math display">\[\beta_{N-1}(S_{t_{N-1}}^{(N)})S_{t_N}^{0}(b_N - h_N)=f((1+b_N)S_{t_{N-1}}^{(N)})(1+h_N) - f((1+h_N)S_{t_{N-1}}^{(N)})(1+b_N)\]</span></p>
<p>Finally, we get :</p>
<p><span class="math display">\[\alpha_{N-1}(S_{t_{N-1}}^{(N)}) = \frac{f((1 + h_N)S_{t_{N-1}}^{(N)}) - f((1 + b_N)S_{t_{N-1}}^{(N)})}{S_{t_{N-1}}^{(N)}(h_N - b_N)}\]</span> <span class="math display">\[\beta_{N-1}(S_{t_{N-1}}^{(N)}) = \frac{f((1+b_N)S_{t_{N-1}}^{(N)})(1+h_N) - f((1+h_N)S_{t_{N-1}}^{(N)})(1+b_N)}{(1+r_N)^N(b_N - h_N)}\]</span></p>
<div id="question-6" class="section level4">
<h4><strong>Question</strong></h4>
<p><span class="math display">\[\alpha_{k-1}(S_{t_{k-1}}^{(N)})(1 + h_N)S_{t_{k-1}}^{(N)} +\beta_{k-1}(S_{t_{k-1}}^{(N)})S_{t_k}^{0}=v_k((1+h_N)S_{t_{k-1}}^{(N)})\]</span></p>
<p><span class="math display">\[\alpha_{k-1}(S_{t_{k-1}}^{(N)})(1+b_N)S_{t_{k-1}}^{(N)} +\beta_{k-1}(S_{t_{k-1}}^{(N)})S_{t_k}^{0}=f((1+b_N)S_{t_{k-1}}^{(N)})\]</span></p>
<p>By the same method we obtain :</p>
<p><span class="math display">\[\alpha_{k-1}(S_{t_{N-1}}^{(N)}) = \frac{v_k((1 + h_N)S_{t_{k-1}}^{(N)}) - v((1 + b_N)S_{t_{k-1}}^{(N)})}{S_{t_{k-1}}^{(N)}(h_N - b_N)}\]</span></p>
<p>And,</p>
<p><span class="math display">\[\beta_{k-1}(S_{t_{k-1}}^{(N)}) = \frac{v((1+b_N)S_{t_{k-1}}^{(N)})(1+h_N) - v((1+h_N)S_{t_{k-1}}^{(N)})(1+b_N)}{(1+r_N)^N(b_N - h_N)}\]</span></p>
</div>
<div id="question-7" class="section level4">
<h4><strong>Question</strong></h4>
<p>[language=Python,caption=Comparison of Price1 and Price2]</p>
<pre class="python"><code>def couverture(N,s,rN,hN,bN,f):
    Sh = price2(N,rN,hN,bN,(1+hN)*s,f);
    Sb = price2(N,rN,hN,bN,(1+bN)*s,f);
    alpha =  (Sh-Sb)/(s*(hN-bN));
    beta = (Sh(1+bN)-Sb(1+hN))/((1+rN)**N *(bN-hN));
    print(alpha)
    print(beta)</code></pre>

</div>
</div>
</div>
<div id="black-scholes-model" class="section level1">
<h1>Black-Scholes’ Model</h1>
<div id="the-modal" class="section level3">
<h3>The modal</h3>
<p>Îto’s formula is given by :</p>
<pre><code>Let g be a function in $C^2$. Then the differential of the processus $g(S_t)$ satisfies:
$$dg(S_t)=g^{&#39;}(S_t)dS_t + \frac{|\sigma S_t|^2}{2}g^{&#39;&#39;}(S_t)dt$$</code></pre>
<div id="question-8" class="section level4">
<h4><strong>Question</strong></h4>
<p>We apply the previous lemma with <span class="math inline">\(S_t \longrightarrow ln(S_t)\)</span>. Then, we have : <span class="math display">\[dln(S_t) = \frac{1}{S_t}dS_t + \frac{|\sigma S_t|^2}{2}(-\frac{1}{S_t^2})dt\]</span> But: $ dS_t = S_t(rdt+dB_t)$ Then : <span class="math display">\[ dln(S_t) = rdt + \sigma dB_t - \frac{\sigma^2}{2}dt\]</span> Then : <span class="math display">\[ \frac{dln(S_t)}{dt} = r + \sigma\frac{B_t}{dt} - \frac{\sigma^2}{2}\]</span> An indefinite integration on <span class="math inline">\(t\)</span> and an evaluation in <span class="math inline">\(0\)</span> gives us : <span class="math display">\[ln(S_t) = rt +\sigma B_t - \frac{\sigma^2}{2}t + c^{te} \text{ with } c^{te}= ln(s)\]</span> by applying the exponential function (continous), we finally get : <span class="math display">\[ S_t = \exp(rt + \sigma B_t - \frac{\sigma^2}{2}t )  \times s\]</span></p>
</div>
</div>
<div id="a-pricer-with-monte-carlo-method" class="section level3">
<h3>A pricer with Monte-Carlo Method</h3>
<p>The price formula of an asset is given by : <span class="math inline">\(p:=\mathbb{E}[e^{-rT}f(S_t)]\)</span></p>
<p>Let <span class="math inline">\((\xi_i)_{1\leqslant i \leqslant n}\)</span> be a sequence of random variables on some probability space <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span>. They are supposed <span class="math inline">\(i.i.d\)</span> and they follow a <span class="math inline">\(normal\)</span> <span class="math inline">\(distribution\)</span> with parameter <span class="math inline">\(m=0\)</span>, <span class="math inline">\(\sigma=1\)</span>. We define : <span class="math display">\[\hat{p}_{(N)}:=\frac{1}{n}\sum_{i=1}^{n}e^{-rT}f(s\times\exp((r-\frac{\sigma^2}{2})T+\sigma\sqrt{T}\xi_i))\]</span></p>
<div id="question-9" class="section level4">
<h4><strong>Question</strong></h4>
<p>[language=Python,caption=Price3]</p>
<pre class="python"><code>def price3(n, s, r, o, T, f):
    return 1.0 / n * exp(-r * T) * sum([f(s * exp((r - o*o/2.0)*T + o * sqrt(T) * ksi)) for ksi in rnorm(0.0, 1.0, n)])</code></pre>
</div>
<div id="question-10" class="section level4">
<h4><strong>Question</strong></h4>
<p>{Plot of Price3}</p>
<p>Let start with two results quite useful for what’s to come. Let <span class="math inline">\(X_1,X_2,...\)</span> be a sequence of random variables on some probability space <span class="math inline">\((\Omega,\mathcal{F},\mathbb{P})\)</span>. They are supposed <span class="math inline">\(identically\)</span> <span class="math inline">\(distributed\)</span>. Define <span class="math inline">\(S_n=X_1+ ... +X_n\)</span>. The <span class="math inline">\(Strong\)</span> <span class="math inline">\(Law\)</span> <span class="math inline">\(of\)</span> <span class="math inline">\(Large\)</span> <span class="math inline">\(Numbers\)</span> specifies :</p>
<pre><code>If the $X_n$ are independent and identically distributed and have finite mean then 
$$ \mathbb{P}[\lim_{n}n^{-1}S_n=\mathbb{E}[X_1]]=1$$</code></pre>
<p>If the <span class="math inline">\(X_n\)</span> are independent and let <span class="math inline">\(f\)</span> be a measurable function then the <span class="math inline">\(f(X_n)\)</span> are independent.</p>
</div>
<div id="question-11" class="section level4">
<h4><strong>Question</strong></h4>
<p>Let <span class="math inline">\(X_1,X_2,...\)</span> be a sequence of random variables define by <span class="math inline">\((e^{-rT}f(s\times\exp((r+\frac{\sigma^2}{2})T + \sigma\sqrt{T}\xi_i)))_{i\in\{1,...,n\}}\)</span>. We have with the hypotheses that <span class="math inline">\((\xi_i)_{i\in\{1,...,\}}\)</span> are <span class="math inline">\(i.i.d\)</span>. Therefore the <span class="math inline">\(X_n\)</span> are i.i.d.<br />
Moreover we should check if <span class="math inline">\(\mathbb{E}[X_1]\)</span> exits but if we do obtain p in the end then everything will be demonstrated. We can apply the <span class="math inline">\(Strong\)</span> <span class="math inline">\(Law\)</span> <span class="math inline">\(of\)</span> <span class="math inline">\(Large\)</span> <span class="math inline">\(Number\)</span> which gives us : <span class="math display">\[\mathbb{P}[\lim_{n}\frac{1}{n}\sum_{i=0}^{n}X_i = \mathbb{E}[X_1]]=1 \text{ i.e } \frac{1}{n}\sum_{i=0}^{n}X_i \underset{p.s}{\longrightarrow} \mathbb{E}[X_1]\]</span> We shall now show that <span class="math inline">\(\mathbb{E}[X_1]=p\)</span>. Let start from <span class="math inline">\(\mathbb{E}[X_1]\)</span> We know that <span class="math inline">\(B\)</span> is a brownien movement so <span class="math inline">\(B_t - B_s \sim \mathcal{N}(0,t-s)\)</span>. Then with <span class="math inline">\(s=0\)</span> comes <span class="math inline">\(B_T - B_s \sim \mathcal{N}(0,T-s)\)</span>. But <span class="math inline">\(B_0=0\)</span> and we divide by <span class="math inline">\(\sqrt{T}\)</span> to obtain <span class="math inline">\(\frac{B_T}{\sqrt{T}}\sim\mathcal{N}(0,1)\)</span>. Therefore we define <span class="math inline">\(\xi_1=\frac{B_T}{\sqrt{T}}\)</span>. And finally we do have by applying question 11. result (and <span class="math inline">\(\mathbb{E}[X_1]\)</span> does exist) <span class="math display">\[\mathbb{E}[X_1]= \mathbb{E}[e^{-rT}f(s\times\exp((r-\frac{\sigma^2}{2})T + \sigma B_T] = \mathbb{E}[e^{-rT}f(S_T)]=p\]</span> To conclude : <span class="math display">\[\hat{p}_{(N)} \underset{p.s}{\longrightarrow} p\]</span></p>
</div>
</div>
<div id="pricer-by-a-close-formula" class="section level3">
<h3>Pricer by a close formula</h3>
<div id="question-12" class="section level4">
<h4><strong>Question</strong></h4>
<p>[language=Python,caption=Put function]</p>
<pre class="python"><code>def put(s,r,sigma,T,K):
    d = 1/(sigma*sqrt(T))*(log(s/K)+(r+sigma**2/2)*T);
    va = norm()
    F1 = va.cdf(-d+sigma*sqrt(T))
    F2 = va.cdf(-d)
    return -s*F2+K*exp(-r*T)*F1</code></pre>
</div>
<div id="question-13" class="section level4">
<h4><strong>Question</strong></h4>

</div>
<div id="question-14" class="section level4">
<h4><strong>Question</strong></h4>

</div>
<div id="question-15" class="section level4">
<h4><strong>Question</strong></h4>

</div>
<div id="question-16" class="section level4">
<h4><strong>Question</strong></h4>

<p>We see that <span class="math inline">\(Price2\)</span> seems to converge to the value of <span class="math inline">\(put\)</span>.</p>
</div>
</div>
</div>
<div id="black-scholes-pde" class="section level1">
<h1>Black-Scholes’ PDE</h1>
<p>All along this section, we will consider the Black-Scholes’ equation given by : <span class="math display">\[ \frac{\partial P}{\partial t} + rS \frac{\partial P}{\partial S} + \frac{1}{2}\sigma^2S^2\frac{\partial^2 P}{\partial S^2} = rP \]</span></p>
A few notation :

<div id="finite-difference-explicite-method" class="section level3">
<h3>Finite difference explicite method</h3>
<p><span class="math display">\[\frac{\partial P_i^n}{\partial T} \approx \frac{P_i^{n+1}-P_i^n}{\Delta T}\]</span> <span class="math display">\[\frac{\partial P_i^n}{\partial s} \approx \frac{P_{i}^{n}-P_{i-1}^n}{\Delta s}\]</span> <span class="math display">\[\frac{\partial^2 P_i^n}{\partial s^2} \approx \frac{P_{i+1}^{n}-2P_i^n+P_{i-1}^n}{\Delta s^2}\]</span></p>
<p>Therefore, we have : <span class="math display">\[ P_i^{n+1} = rP_i^{n+1}\Delta T + P_i^n - rS\frac{\Delta T}{2\Delta s}(P_{i}^n - P_{i-1}^n) - \frac{1}{2}\sigma^2S^2\frac{\Delta T}{\Delta s^2}(P_{i+1}^n-2P_i^n+P_{i-1}^n)\]</span> <span class="math display">\[ (1-r\Delta T)P_i^{n+1} = (\frac{rS\Delta T}{\Delta s}-\frac{\sigma^2S^2\Delta T}{2\Delta s^2})P_{i-1}^n 
(-rS\Delta T +1+ \frac{\sigma^2S^2\Delta T}{\Delta s^2})P_i^n +( - \frac{\sigma^2S^2\Delta T}{2\Delta s^2})P_{i+1}^n\]</span></p>
</div>
<div id="finite-difference-implicite-method" class="section level3">
<h3>Finite difference implicite method</h3>
<p><span class="math display">\[\frac{\partial P_i^{n}}{\partial T} \approx \frac{P_i^{n+1}-P_i^n}{\Delta T}\]</span> <span class="math display">\[\frac{\partial P_i^{n}}{\partial s} \approx \frac{P_{i}^{n+1}-P_{i-1}^{n+1}}{\Delta s}\]</span> <span class="math display">\[\frac{\partial^2 P_i^{n}}{\partial s^2} \approx \frac{P_{i+1}^{n+1}-2P_i^{n+1}+P_{i-1}^{n+1}}{\Delta s^2}\]</span></p>
<p>Therefore, we have:</p>
<p><span class="math display">\[P_i^n=(\frac{-rS\Delta T }{\Delta s}+\frac{\sigma^2S^2\Delta T}{2\Delta s^2})P_{i-1}^{n+1} + (-r\Delta T + 1 - \frac{\sigma^2S^2\Delta T}{\Delta s^2}-\frac{rS\Delta T}{\Delta S})P_i^{n+1} +(\frac{\sigma^2S^2\Delta T}{2\Delta s^2})P_{i+1}^{n+1}\]</span></p>
</div>
<div id="crank-nicholson-method" class="section level3">
<h3>Crank-Nicholson method</h3>
<p>The Crank-Nicholson method result of taking the mean of the two previous interpretation (implicite and explicite). It gives us : <span class="math display">\[(I_d + \Delta T B)P^{n+1}=(I_d +\Delta T A)P^n +\frac{1}{2}(Cond_1 + Cond_2)\]</span></p>
<p>Let assume that <span class="math inline">\((I_d + \Delta T B)\)</span> is inversible then we should come with the following equation : <span class="math display">\[P^{n+1}=(I_d + \Delta T B)^{-1}[(I_d +\Delta T A)P^n +\frac{1}{2}(Cond_1 + Cond_2)]\]</span></p>
</div>
<div id="linear-algebra-redefinition" class="section level3">
<h3>Linear algebra Redefinition</h3>
<p>We now rewrite this equation using linear algebra:</p>
<p><span class="math display">\[BP^{n+1} = AP^n + Cond_i,\]</span></p>
<p><span class="math display">\[ \text{ where } A = \left(\begin{array}{cccccc}A_{0,0} &amp; A_{0,1} &amp; 0 &amp; .. &amp; .. &amp; 0 \\A_{1,0} &amp; .. &amp; .. &amp; .. &amp;  &amp; : \\0 &amp; .. &amp; .. &amp; .. &amp; .. &amp; 0 \\: &amp; .. &amp; .. &amp; .. &amp; .. &amp; 0 \\: &amp;  &amp; .. &amp; .. &amp; .. &amp; A_{M,M+1} \\0 &amp; .. &amp; .. &amp; 0 &amp; A_{M+1,M} &amp; A_{M+1,M+1}\end{array}\right)\]</span> <span class="math display">\[\text{ and } B = \left(\begin{array}{cccccc}B_{0,0} &amp; B_{0,1} &amp; 0 &amp; .. &amp; .. &amp; 0 \\B_{1,0} &amp; .. &amp; .. &amp; .. &amp;  &amp; : \\0 &amp; .. &amp; .. &amp; .. &amp; .. &amp; : \\: &amp; .. &amp; .. &amp; .. &amp; .. &amp; 0 \\: &amp;  &amp; .. &amp; .. &amp; .. &amp; A_{M,M+1} \\0 &amp; .. &amp; .. &amp; 0 &amp; B_{M+1,M} &amp; B_{M+1,M+1}\end{array}\right) \]</span> <span class="math display">\[\text{ and } Cond_i=\left(\begin{array}{c}P(t_i,s_0) \\0 \\: \\: \\0 \\P(t_i,s_{M+1})\end{array}\right)\]</span></p>
<p><em>For the explicite version, we get:</em> <span class="math inline">\(\forall j\in \{1,...,M\},\)</span> <span class="math display">\[A_{j,j+1}=\frac{\sigma^2s_j^2}{2\Delta s^2} \text{, } A_{j,j}=\frac{1}{\Delta T} + \frac{rs_j}{\Delta s} + \frac{\sigma^2s_j^2}{\Delta s^2} \text{ and } A_{j,j+1}=-\frac{rs_j}{\Delta s} - \frac{\sigma^2s_j^2}{2\Delta s^2}\]</span> and <span class="math display">\[ B_{j,j-1}=0 \text{, } B_{j,j}=-r +\frac{1}{\Delta T} \text{ and } B_{j,j+1}=0\]</span></p>
<p><em>For the implicite version, it is:</em> <span class="math inline">\(\forall j\in \{1,...,M\},\)</span> <span class="math display">\[A_{j,j-1}=0 \text{, } A_{j,j}=\frac{1}{\Delta T} \text{ and } A_{j,j+1}=0\]</span> and <span class="math display">\[ B_{j,j-1}=\frac{\sigma^2 s_j^2}{2\Delta s^2} \text{, } B_{j,j}=-r + \frac{1}{\Delta T} - \frac{rs_j}{\Delta s} - \frac{\sigma^2s_j^2}{\Delta s^2} \text{ and } B_{j,j+1}=\frac{rs_j}{\Delta s} + \frac{\sigma^2s_j^2}{\Delta s^2}\]</span></p>
<p><em>And finally, for Crank-Nicholson:</em> <span class="math inline">\(\forall j\in \{1,...,M\},\)</span> <span class="math display">\[A_{j,j-1}=-\frac{\sigma^2s_j^2}{4\Delta s^2} \text{, } A_{j,j}=\frac{1}{\Delta T} + \frac{rs_j}{2\Delta s} +\frac{\sigma^2s_j^2}{2\Delta s^2} \text{ and } A_{j,j+1}= -\frac{rs_j}{2\Delta s} - \frac{\sigma^2s_j^2}{4\Delta s^2}\]</span> and <span class="math display">\[B_{j,j-1}= \frac{\sigma^2s_j^2}{4\Delta s^2} \text{, } B_{j,j} = -r + \frac{1}{\Delta T} - \frac{rs_j}{2\Delta s} -\frac{\sigma^2 s_j^2}{2\Delta s^2} \text{ and } B_{j,j+1}=\frac{rs_j}{2\Delta s} + \frac{\sigma^2s_j^2}{4\Delta s^2}\]</span></p>
<p>For all three preceding situation, we initialize : <span class="math display">\[A_{0,0}=A_{0,1}=A_{M+1,M}=A_{M+1,M+1}=B_{0,0}=B_{0,1}=B_{M+1,M}=B_{M+1,M+1}=0\]</span></p>

</div>
<div id="cfl-condition" class="section level3">
<h3>CFL condition</h3>
<p>Pour la méthode explicit, le schéma est stable si le pas de temps est de l’ordre du carré du pas d’espace. Autrement dit, si : <span class="math display">\[\Delta t\approx \Delta s^2\]</span></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
